#!/bin/bash
# Ensure the log file is passed as an argument
if [ $# -ne 1 ]; then
  echo "Usage: $0 <logfile>"
  exit 1
fi

logfile=$1

# Process the log file with awk
awk '
{
  ip = $1;
  code = $9;
  count[ip " " code]++;
}
END {
  for (entry in count) {
    print count[entry], entry;
  }
}
' "$logfile" | sort -nr
